<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ابن نافع — ibn nafaa</title>

  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0B132B">

  <style>
    :root{
      --bg:#0B132B; --card:#0f2038; --gold:#C5A365; --muted:#9fb3d9; --glass: rgba(255,255,255,0.03);
    }
    *{box-sizing:border-box;font-family:"Tajawal",sans-serif}
    html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg),#020617);color:#eef6ff}
    header{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;background:linear-gradient(90deg,rgba(255,255,255,0.02),transparent);backdrop-filter:blur(8px);border-bottom:1px solid rgba(255,255,255,0.02)}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--gold),#F3E0B5);display:flex;align-items:center;justify-content:center;color:#051224;font-weight:900;font-size:18px}
    .title{font-weight:900;font-size:16px}
    .subtitle{font-size:12px;color:var(--muted)}
    nav a{color:var(--muted);text-decoration:none;margin-left:12px;font-weight:600}
    main{max-width:980px;margin:18px auto;padding:12px}
    .card{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border-radius:12px;padding:16px;margin-bottom:14px;border:1px solid rgba(255,255,255,0.02);box-shadow:0 10px 30px rgba(2,6,23,0.6)}
    h2{margin:0 0 8px 0;color:#fff}
    p.lead{color:var(--muted);margin:0 0 8px 0}
    textarea,input,select{width:100%;padding:12px;border-radius:10px;border:none;background:var(--glass);color:inherit;outline:none}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .btn{background:linear-gradient(90deg,var(--gold),#FFD99C);border:none;padding:10px 14px;border-radius:9px;cursor:pointer;font-weight:700;color:#051224}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)}
    .small{font-size:13px;color:var(--muted)}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:10px;margin-top:10px}
    .time-box{background:rgba(255,255,255,0.02);padding:12px;border-radius:10px;text-align:center}
    .countdown{font-weight:800;font-size:18px;color:#fff}
    .tasbih-count{font-size:48px;font-weight:900;color:var(--gold)}
    footer{text-align:center;color:var(--muted);padding:16px;margin-top:8px}
    .lang-switch{cursor:pointer;padding:6px 10px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:var(--muted)}
    @media(max-width:600px){.row{flex-direction:column}}
  </style>
</head>
<body>

<header>
  <div class="brand">
    <div class="logo">ب</div>
    <div>
      <div class="title">ابن نافع</div>
      <div class="subtitle">ibn nafaa — Quran • Prayer • Azkar</div>
    </div>
  </div>
  <nav>
    <a href="#home">الرئيسية</a>
    <a href="#quran">القرآن</a>
    <a href="#tasbih">السبحة</a>
    <a href="#prayer">الصلاة</a>
    <a href="#lessons">الدروس</a>
    <button class="lang-switch" id="switchLang">EN</button>
  </nav>
</header>

<main>
  <section id="quran" class="card">
    <h2>القرآن الكريم</h2>
    <p class="small">استمع لتلاوة عالية الجودة من قارئك المفضل.</p>

    <div class="row">
      <select id="surahSelect"><option>تحميل السور...</option></select>
      <select id="reciterSelect">
        <option value="ar.alafasy">مشاري العفاسي</option>
        <option value="ar.husary">الحصري</option>
        <option value="ar.abdulbasitmurattal">عبدالباسط</option>
      </select>
      <button class="btn" id="playSurahBtn">تشغيل السورة</button>
    </div>

    <div id="quranContent" style="margin-top:12px;direction:rtl"></div>
  </section>

  <audio id="audioPlayer" preload="none" controls style="width:100%;margin-top:10px"></audio>
</main>

<footer>© ابن نافع — Quran & Azkar</footer>

<script>
const QURAN_API = 'https://api.alquran.cloud/v1';
const $ = id => document.getElementById(id);

// تحميل قائمة السور
async function loadSurahList(){
  try{
    const res = await fetch(`${QURAN_API}/surah`);
    const j = await res.json();
    const sel = $('surahSelect');
    sel.innerHTML = '';
    j.data.forEach(s=>{
      const opt=document.createElement('option');
      opt.value=s.number;
      opt.textContent=`${s.number} - ${s.englishName} (${s.name})`;
      sel.appendChild(opt);
    });
  }catch(e){$('surahSelect').innerHTML='<option>تعذر التحميل</option>';console.warn(e);}
}

// تشغيل السورة بصوت القارئ المحدد
async function playRecitation(surah=1, reciter='ar.alafasy'){
  try{
    const url = `https://cdn.islamic.network/quran/audio/128/${reciter}/${surah}.mp3`;
    const ap = $('audioPlayer');
    ap.src = url;
    await ap.play();
  }catch(e){
    console.warn(e);
    alert('يرجى الضغط على الشاشة أولاً لتفعيل الصوت (سياسة المتصفح).');
  }
}

$('playSurahBtn').addEventListener('click', ()=>{
  const s = $('surahSelect').value || 1;
  const r = $('reciterSelect').value;
  playRecitation(s, r);
});

loadSurahList();
</script>
</body>
</html>
