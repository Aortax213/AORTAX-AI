<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AORTAX VISION — Abo Wateen Studio</title>

  <!-- PWA manifest -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#001428">
  <!-- أيقونة متصفح -->
  <link rel="icon" href="icon-192.png" type="image/png">

  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{
      font-family: "Poppins", system-ui, sans-serif;
      background: radial-gradient(circle at top, #0b0b1a, #000);
      color:#e6eef8;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      direction:rtl;
      line-height:1.5;
      padding-bottom:3rem;
    }

    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:1rem;
      padding:1rem 1.25rem;
      background:rgba(255,255,255,0.03);
      border-bottom:1px solid rgba(255,255,255,0.04);
      position:sticky;
      top:0;
      z-index:999;
      backdrop-filter:blur(8px);
    }
    .brand{display:flex;align-items:center;gap:.75rem}
    .logo-circle{
      width:44px;height:44px;border-radius:10px;
      background:linear-gradient(135deg,#007AFF,#6C5CE7);
      display:flex;align-items:center;justify-content:center;
      font-weight:800;color:#fff;font-size:18px;box-shadow:0 6px 18px rgba(0,122,255,0.14);
    }
    .title{font-weight:700;color:#cfe7ff}

    nav a{color:#a8c6ff;text-decoration:none;margin-left:12px;font-weight:600;}
    nav a:hover{color:#fff}

    main{max-width:920px;margin:1.25rem auto;padding:0 1rem;}
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:12px;padding:1.25rem;margin-bottom:1rem;
      box-shadow:0 6px 22px rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.03);
    }

    h1{font-size:1.35rem;margin-bottom:.5rem;color:#fff}
    p.lead{color:#bcd7ff;margin-bottom:1rem}

    .controls{display:flex;gap:.75rem;flex-wrap:wrap;align-items:center;justify-content:center;margin-top:.6rem}
    .prompt{
      width:100%;max-width:720px;padding:.8rem 1rem;border-radius:10px;border:none;
      background:rgba(255,255,255,0.04);color:#eaf4ff;font-size:1rem;text-align:right;
      outline:none;box-shadow:inset 0 1px 0 rgba(255,255,255,0.02);
    }
    .btn{
      background:#007AFF;border:none;color:#fff;padding:.7rem 1.05rem;border-radius:10px;font-weight:700;cursor:pointer;
      box-shadow:0 8px 24px rgba(0,122,255,0.14);transition:transform .12s;
    }
    .btn.secondary{background:transparent;border:1px solid rgba(255,255,255,0.06);color:#cfe7ff}
    .btn:active{transform:translateY(1px)}

    .generated{
      display:flex;flex-direction:column;align-items:center;gap:.6rem;margin-top:1rem;
    }
    .generated img{max-width:100%;width:360px;border-radius:12px;box-shadow:0 12px 40px rgba(0,122,255,0.14)}
    .small{font-size:.85rem;color:#b8d4ff}

    .grid{
      display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:10px;margin-top:1rem;
    }
    .thumb{border-radius:10px;overflow:hidden;background:#0b0b13;border:1px solid rgba(255,255,255,0.03)}
    .thumb img{width:100%;height:140px;object-fit:cover;display:block}

    footer{text-align:center;color:#8fb4ff;padding:1rem 0;margin-top:1.5rem;font-size:.9rem}

    /* responsive */
    @media (max-width:600px){
      .generated img{width:90%}
      nav{display:none}
    }
  </style>
</head>
<body>

  <header>
    <div class="brand">
      <div class="logo-circle">A</div>
      <div>
        <div class="title">AORTAX VISION</div>
        <div class="small">Abo Wateen Studio — تجربة صور ذكاء اصطناعي</div>
      </div>
    </div>

    <nav>
      <a href="#studio">الاستوديو</a>
      <a href="#gallery">المعرض</a>
      <a href="#inspire">إلهام</a>
      <a href="#profile">الملف</a>
    </nav>
  </header>

  <main>
    <section class="card" id="studio" aria-labelledby="studioTitle">
      <h1 id="studioTitle">AI Studio — استوديو الذكاء الاصطناعي</h1>
      <p class="lead">اكتب وصف الصورة بالعربية أو الإنجليزية — اضغط "توليد" وستظهر نتيجتك فورًا. مدعوم بـ Pollinations (بدون API Key).</p>

      <div style="display:flex;flex-direction:column;align-items:center">
        <input id="prompt" class="prompt" placeholder="مثال: مدينة مستقبلية تحت أمطار نيّونية — تفصيل: ضوء أزرق، نمط فوتوغرافي" />
        <div class="controls" style="margin-top:12px">
          <button class="btn" id="generateBtn">توليد الصورة</button>
          <button class="btn secondary" id="saveBtn" title="حفظ الصورة">حفظ</button>
          <button class="btn secondary" id="downloadBtn" title="تحميل الصورة">تحميل</button>
        </div>

        <div class="generated" id="generatedArea" aria-live="polite" style="min-height:120px">
          <!-- الصورة تظهر هنا -->
        </div>

        <div style="margin-top:12px;width:100%;max-width:720px;text-align:center;color:#9fc2ff;font-size:.9rem">
          <span>نصيحة: أضف وصفًا تفصيليًا لتحصل على نتيجة احترافية أكثر (مادة، إضاءة، زاوية، أسلوب فني).</span>
        </div>
      </div>
    </section>

    <section class="card" id="gallery" aria-labelledby="galleryTitle">
      <h1 id="galleryTitle">معرض مختار</h1>
      <p class="small">أمثلة سريعة من روابط Pollinations (عرض فقط).</p>

      <div class="grid">
        <div class="thumb"><img src="https://image.pollinations.ai/prompt/neon%20city%20at%20night" alt=""></div>
        <div class="thumb"><img src="https://image.pollinations.ai/prompt/futuristic%20portrait%20cyberpunk" alt=""></div>
        <div class="thumb"><img src="https://image.pollinations.ai/prompt/ultra%20realistic%20landscape" alt=""></div>
        <div class="thumb"><img src="https://image.pollinations.ai/prompt/minimalist%20space%20scene" alt=""></div>
      </div>
    </section>

    <section class="card" id="inspire" aria-labelledby="inspireTitle">
      <h1 id="inspireTitle">إلهام</h1>
      <p class="small">صور مميزة يوميًا — جرّب أوصاف قصيرة وطويلة لتجارب مختلفة.</p>
    </section>

    <section class="card" id="profile" aria-labelledby="profileTitle">
      <h1 id="profileTitle">الملف</h1>
      <p class="small">ميزة التسجيل وحفظ الأعمال قيد التطوير — يمكن إضافة Google Sign-in لاحقًا.</p>
    </section>
  </main>

  <footer>© AORTAX VISION — Abo Wateen Studio · تواصل: <a href="https://instagram.com/okba_bzg" target="_blank" style="color:#9fd1ff">okba_bzg</a></footer>

  <!-- Service worker registration -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/service-worker.js')
        .then(reg => console.log('Service Worker مسجل:', reg.scope))
        .catch(err => console.warn('فشل تسجيل Service Worker:', err));
      });
    }
  </script>

  <!-- Pollinations generator script (simple) -->
  <script>
    const genBtn = document.getElementById('generateBtn');
    const out = document.getElementById('generatedArea');
    const promptInput = document.getElementById('prompt');
    const downloadBtn = document.getElementById('downloadBtn');
    const saveBtn = document.getElementById('saveBtn');

    function showMessage(text, color='#ffd9d9'){
      out.innerHTML = `<div style="color:${color};padding:12px;border-radius:8px">${text}</div>`;
    }

    genBtn.addEventListener('click', () => {
      const prompt = promptInput.value.trim();
      if(!prompt) return showMessage('رجاءً اكتب وصفًا للصورة أولاً.', '#ffcccb');
      showMessage('جارٍ التوليد... انتظر ثوانٍ قليلة ✨', '#d6f8e8');

      const url = 'https://image.pollinations.ai/prompt/' + encodeURIComponent(prompt);
      // نعرض الصورة (Pollinations يعيد صورة عبر رابط مباشر)
      const img = new Image();
      img.src = url;
      img.alt = prompt;
      img.onload = () => {
        out.innerHTML = '';
        img.style.borderRadius = '12px';
        img.style.maxWidth = '100%';
        img.style.boxShadow = '0 12px 40px rgba(0,122,255,0.14)';
        out.appendChild(img);

        // نجعل أزرار التنزيل تعمل
        downloadBtn.onclick = () => {
          const a = document.createElement('a');
          a.href = img.src;
          a.download = 'AORTAX-image.png';
          document.body.appendChild(a);
          a.click();
          a.remove();
        };

        // حفظ محلي داخل الـ IndexedDB / LocalStorage (بسيط)
        saveBtn.onclick = async () => {
          try {
            const res = await fetch(img.src);
            const blob = await res.blob();
            const reader = new FileReader();
            reader.onload = () => {
              // نخزن كـ base64 في localStorage (مناسب لتجارب صغيرة)
              const key = 'aortax_saved_' + Date.now();
              localStorage.setItem(key, reader.result);
              alert('تم الحفظ محليًا في المتصفح (localStorage).');
            };
            reader.readAsDataURL(blob);
          } catch(e){ alert('فشل في حفظ الصورة: ' + e); }
        };
      };

      img.onerror = () => {
        showMessage('حدث خطأ أثناء تحميل الصورة. جرّب وصفًا آخر أو انتظر قليلاً.', '#ffd6d6');
      };
    });

    // تفعيل زر Enter
    promptInput.addEventListener('keydown', (e) => {
      if(e.key === 'Enter') genBtn.click();
    });
  </script>

</body>
</html>
